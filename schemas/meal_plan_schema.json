{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Meal Plan Schema",
  "description": "Weekly meal plan that references meals from the database",
  "type": "object",
  "required": ["scheduled_meals", "shopping_trips"],
  "properties": {
    "scheduled_meals": {
      "type": "array",
      "description": "Meals scheduled for cooking",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["id", "meal_id", "cooking_dates", "meal_type", "assigned_cook", "eating_dates_per_person"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for this scheduled meal instance (format: sm_{timestamp})",
            "example": "sm_1704441600000"
          },
          "meal_id": {
            "type": "string",
            "description": "Reference to recipe in meals database",
            "example": "spaghetti_carbonara"
          },
          "cooking_dates": {
            "type": "array",
            "description": "Dates when this meal will be cooked. If 1 date: meal prep. If multiple: cook separately.",
            "items": {
              "type": "string",
              "format": "date"
            },
            "minItems": 1,
            "example": ["2026-01-06"]
          },
          "meal_type": {
            "type": "string",
            "enum": ["breakfast", "second_breakfast", "dinner", "supper"],
            "description": "Type of meal (breakfast, second_breakfast, dinner, or supper)"
          },
          "assigned_cook": {
            "type": "string",
            "enum": ["John", "Jane", "both"],
            "description": "Who cooks this meal"
          },
          "eating_dates_per_person": {
            "type": "object",
            "description": "Dates when each person will eat this meal. Each date represents 1 portion. Must be >= first cooking date.",
            "properties": {
              "John": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "date"
                },
                "minItems": 1,
                "description": "Eating dates for John",
                "example": ["2026-01-06", "2026-01-07"]
              },
              "Jane": {
                "type": "array",
                "items": {
                  "type": "string",
                  "format": "date"
                },
                "minItems": 1,
                "description": "Eating dates for Jane",
                "example": ["2026-01-06"]
              }
            }
          },
          "prep_assigned_to": {
            "type": "string",
            "enum": ["John", "Jane", "both"],
            "description": "Who does prep tasks (if different from cook)"
          }
        }
      }
    },
    "shopping_trips": {
      "type": "array",
      "description": "Planned shopping trips",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["shopping_date", "scheduled_meal_ids"],
        "properties": {
          "shopping_date": {
            "type": "string",
            "format": "date",
            "description": "Shopping date (YYYY-MM-DD)",
            "example": "2026-01-05"
          },
          "scheduled_meal_ids": {
            "type": "array",
            "description": "Scheduled meal instance IDs to shop for (references the 'id' field from scheduled_meals)",
            "items": {
              "type": "string"
            },
            "minItems": 1,
            "example": ["sm_1704441600000", "sm_1704528000000"]
          }
        }
      }
    }
  }
}
