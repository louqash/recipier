{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Meal Planning Schema",
  "description": "Schema for meal planning with cooking and shopping tasks for Lukasz and Gaba. Generate meal plans that will be converted into Todoist tasks.",
  "type": "object",
  "required": ["meals", "shopping_trips"],
  "properties": {
    "meals": {
      "type": "array",
      "description": "List of meals to cook",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["meal_id", "name", "date", "meal_type", "assigned_cook", "ingredients"],
        "properties": {
          "meal_id": {
            "type": "string",
            "description": "Unique identifier for this meal (e.g., 'meal_001')",
            "pattern": "^meal_[0-9]{3}$",
            "example": "meal_001"
          },
          "name": {
            "type": "string",
            "description": "Name of the dish",
            "example": "Spaghetti Carbonara"
          },
          "date": {
            "type": "string",
            "format": "date",
            "description": "Date when this meal should be cooked (YYYY-MM-DD)",
            "example": "2026-01-06"
          },
          "meal_type": {
            "type": "string",
            "enum": ["breakfast", "lunch", "dinner", "snack"],
            "description": "Type of meal"
          },
          "assigned_cook": {
            "type": "string",
            "enum": ["Lukasz", "Gaba", "both"],
            "description": "Who is responsible for cooking this meal"
          },
          "ingredients": {
            "type": "array",
            "description": "List of ingredients needed for this meal (TOTAL amounts for shopping)",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["name", "quantity", "unit", "category"],
              "properties": {
                "name": {
                  "type": "string",
                  "description": "Name of the ingredient",
                  "example": "spaghetti"
                },
                "quantity": {
                  "type": "number",
                  "description": "TOTAL amount needed for all people",
                  "example": 400
                },
                "unit": {
                  "type": "string",
                  "description": "Unit of measurement (g, kg, ml, l, pieces, cups, tbsp, tsp, etc.)",
                  "example": "g"
                },
                "category": {
                  "type": "string",
                  "enum": ["produce", "meat", "dairy", "pantry", "frozen", "bakery", "beverages", "other"],
                  "description": "Shopping category for organizing the shopping list"
                },
                "notes": {
                  "type": "string",
                  "description": "Optional notes about the ingredient (e.g., 'organic', 'fresh', 'specific brand')",
                  "example": "fresh, not dried"
                },
                "per_person": {
                  "type": "object",
                  "description": "Per-person breakdown of this ingredient for cooking portions. Include only people who will eat this meal. Omit people who don't eat this meal.",
                  "properties": {
                    "Lukasz": {
                      "type": "object",
                      "required": ["quantity", "unit", "portions"],
                      "properties": {
                        "quantity": {"type": "number", "example": 600, "description": "Total amount for this person (all portions combined)"},
                        "unit": {"type": "string", "example": "g"},
                        "portions": {"type": "integer", "minimum": 1, "example": 3, "description": "Number of portions this makes (e.g., 600g = 3 portions × 200g per portion)"}
                      }
                    },
                    "Gaba": {
                      "type": "object",
                      "required": ["quantity", "unit", "portions"],
                      "properties": {
                        "quantity": {"type": "number", "example": 400, "description": "Total amount for this person (all portions combined)"},
                        "unit": {"type": "string", "example": "g"},
                        "portions": {"type": "integer", "minimum": 1, "example": 2, "description": "Number of portions this makes (e.g., 400g = 2 portions × 200g per portion)"}
                      }
                    }
                  }
                }
              }
            }
          },
          "prep_tasks": {
            "type": "array",
            "description": "Optional preparation tasks that should be done before cooking day",
            "items": {
              "type": "object",
              "required": ["description", "days_before", "assigned_to"],
              "properties": {
                "description": {
                  "type": "string",
                  "description": "What needs to be prepared",
                  "example": "Marinate chicken overnight"
                },
                "days_before": {
                  "type": "integer",
                  "description": "How many days before cooking this should be done",
                  "minimum": 1,
                  "example": 1
                },
                "assigned_to": {
                  "type": "string",
                  "enum": ["Lukasz", "Gaba", "both"],
                  "description": "Who should do this prep task"
                }
              }
            }
          },
          "notes": {
            "type": "string",
            "description": "Optional notes about the meal",
            "example": "Gaba's favorite recipe"
          }
        }
      }
    },
    "shopping_trips": {
      "type": "array",
      "description": "Planned shopping trips to buy ingredients",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["date", "meal_ids"],
        "properties": {
          "date": {
            "type": "string",
            "format": "date",
            "description": "When to do the shopping (YYYY-MM-DD). Should be before the meals that need these ingredients.",
            "example": "2026-01-05"
          },
          "meal_ids": {
            "type": "array",
            "description": "List of meal_ids that this shopping trip covers",
            "items": {
              "type": "string"
            },
            "minItems": 1,
            "example": ["meal_001", "meal_002"]
          }
        }
      }
    }
  }
}
